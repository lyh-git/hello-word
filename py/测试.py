#coding=utf-8
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.support import expected_conditions as EC
from selenium.webdriver.support.wait import WebDriverWait
import sys
import io


from lxml import etree
import  time
from bs4 import BeautifulSoup
import requests

path = "C:\Program Files (x86)\Google\Chrome\Application\chromedriver.exe"



driver = webdriver.Chrome(executable_path=path)

driver.get('http://user.qzone.qq.com/839510018/311')
driver.implicitly_wait(10)
try:
    driver.find_element_by_id('login_div')
    a=True
except:
    a=False
if a==True:
        driver.switch_to.frame('login_frame')
        driver.find_element_by_id('switcher_plogin').click()
        driver.find_element_by_id('u').clear()
        driver.find_element_by_id('u').send_keys('1374061712')
        driver.find_element_by_id('p').clear()
        driver.find_element_by_id('p').send_keys('HUA1374061712')
        driver.find_element_by_id('login_button').click()






next_num = 0  # ?????????????id

while True:



        # ????????????????????????????????????

        # ?????????1?????6???? ??5 ?¦Ì???????????

        for i in range(1,6):

            height = 20000*i#??¦Ë???20000????

            strWord = "var q=document.documentElement.scrollTop=(0,"+str(height)+")"

            driver.execute_script(strWord)

            time.sleep(4)



       # ?????????????<frame>??<iframe>????webdriver????¦Ë??????????frame??

        # ????????????????????????frame??????????????????????????

        driver.switch_to.frame("app_canvas_frame")

        selector = etree.HTML(driver.page_source,)

        divs = selector.xpath('//*[@id="msgList"]/li/div[3]')



        #??????? a ???????????????????§Õ??



        for div in divs:

                qq_name = div.xpath('./div[2]/a/text()')

                qq_content = div.xpath('./div[2]/pre/text()')

                qq_time = div.xpath('./div[4]/div[1]/span/a/text()')

                qq_name = qq_name[0] if len(qq_name)>0 else ''

                qq_content = qq_content[0] if len(qq_content)>0 else ''

                qq_time = qq_time[0] if len(qq_time)>0 else ''
                try:
                    print(qq_content)
                except:
                    pass





        # ?????????¦Â??????????????????????id????????????

        if driver.page_source.find('pager_next_' + str(next_num)) == -1:

         break



        # ?????????????????????????????????£???????????????????

        driver.find_element_by_id('pager_next_' + str(next_num)).click()



        # ??????????id

        next_num += 1



        # ?????????????????????????????????????????????frame??

        driver.switch_to.parent_frame()
